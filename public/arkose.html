<html>

<head>

<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
 -->

<!-- javascript -->

<!-- jquery -->
<script src="javascript/jquery.min.js"></script>

<!-- bootstrap -->
<script src="javascript/bootstrap.min.js"></script>

<!-- bootstrap bundle -->
<script src="javascript/bootstrap.bundle.min.js"></script>

<!-- okta sign-in widget -->
<!-- <script src="javascript/okta-sign-in.min.js"></script>
 -->

<!-- <script src="javascript/okta-sign-in.min.js"></script>
 -->

<script src="https://s3.us-east-2.amazonaws.com/tom-smith-okta/okta-widget/okta-sign-in.js"></script>

<script src="https://client.arkoselabs.com/fc/api/?onload=loadChallenge" async defer></script>

<!-- css -->

<link
  href="https://ok1static.oktacdn.com/assets/js/sdk/okta-signin-widget/2.14.0/css/okta-sign-in.min.css"
  type="text/css"
  rel="stylesheet"/>

<link href = "css/okta-theme.css" rel = "stylesheet" type="text/css">

<link href = "css/bootstrap.min.css" rel = "stylesheet" type="text/css">

<script>

// function renderOktaWidget(arkose_token) {

	// console.log("the arkose token is: " + arkose_token)

window.onload = function() {

	var baseUrl = "http://localhost:3378"

	var options = {
		baseUrl: baseUrl
		// contextData: arkose_token 
	}

	var signIn = new OktaSignIn(options)

	signIn.renderEl(
		{ el: '#widget-container'},
		function success(res) {
			console.log("the result of success is: ")

			console.dir(res)

			if (res.status === 'SUCCESS') {

				var sessionToken = res.session.token

				console.log("the res object in success is:")
				console.dir(res)
				console.log("the sessionToken is: " + sessionToken)
			}
			else {
				alert("apparently the user does not have a session")
			}
		}
	)
}


</script>

<!--
    Include our API in the <head> of your page. In the example below, remember to
    replace the <YOUR PUBLIC KEY> with your `public key` and <YOUR CALLBACK> with a name that
    refers to a global function.
    
    e.g. <script src="//api.arkoselabs.com/v2/11111111-1111-1111-1111-111111111111/api.js" data-callback="setupEnforcement" async defer></script>
  -->
<script src="//api.arkoselabs.com/v2/726E9EF7-02A0-C8AD-9B35-5577632DDE75/api.js" data-callback="setupEnforcement" async defer></script>

</head>

<body>


<div class="container">
	<div class="row">
		<div class="col-sm">
			<button id="enforcement-trigger">log in</button>

			<div class="CAPTCHA"></div>

 		</div>
		
		<div class="col-sm">

<!--  			<div id="widget-container" style="display: none"></div>
 -->
 			<div id="widget-container"></div>

		</div>
	</div>
</div>

<script>

  function setupEnforcement(myEnforcement) {
    myEnforcement.setConfig({
      selector: '#enforcement-trigger',
      onCompleted: function(response) {
      	console.log("the response token is:")
        console.log(response.token);
        $("#widget-container").show()
        $("#enforcement-trigger").hide()
        renderOktaWidget(response.token)
      }
    });
  }

</script>

</body>

</html>