<html>

<head>

<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
 -->

<!-- javascript -->

<!-- jquery -->
<script src="javascript/jquery.min.js"></script>

<!-- bootstrap -->
<script src="javascript/bootstrap.min.js"></script>

<!-- bootstrap bundle -->
<script src="javascript/bootstrap.bundle.min.js"></script>

<!-- okta sign-in widget -->
<!-- <script src="javascript/okta-sign-in.min.js"></script>
 -->

<script src="javascript/okta-sign-in.js"></script>

<!-- <script
  src="https://ok1static.oktacdn.com/assets/js/sdk/okta-signin-widget/2.14.0/js/okta-sign-in.min.js"
  type="text/javascript"></script> -->

<!-- css -->

<link href = "css/bootstrap.min.css" rel = "stylesheet" type="text/css">

<link href="https://getbootstrap.com/docs/4.2/examples/starter-template/starter-template.css" rel="stylesheet" type="text/css">

<link
  href="https://ok1static.oktacdn.com/assets/js/sdk/okta-signin-widget/2.14.0/css/okta-sign-in.min.css"
  type="text/css"
  rel="stylesheet"/>

<script>

window.onload = function () {

	var baseUrl = "http://localhost:3378"

	var options = {
		baseUrl: baseUrl,
		contextData: sessionStorage.getItem("arkoseToken")
	}

	var signIn = new OktaSignIn(options)

	signIn.renderEl(
		{ el: '#widget-container'},
		function success(res) {

			console.dir(res)

			if (res.status === 'SUCCESS') {

				var sessionToken = res.session.token

				var oauth_url = "https://okta-arkose.oktapreview.com/oauth2/v1/authorize"

				oauth_url += "?client_id=0oajdyrcz6yCh60oG0h7"
				oauth_url += "&response_type=id_token"
				oauth_url += "&scope=openid&prompt=none"
				oauth_url += "&redirect_uri=http://localhost:3378"
				oauth_url += "&state=Af0ifjslDkj&nonce=n-0S6_WzA2Mj"
				oauth_url += "&sessionToken=" + sessionToken

				location.replace(oauth_url)
			}
			else {
				console.log("something went wrong with the login.")
				console.dir(res)
			}
		},
		function error(err) {
	    	console.log('ERROR: ' + err);
	  	}
	)
}

</script>

</head>

<body>

<nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
  <a class="navbar-brand" href="/">Atko</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarsExampleDefault">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item active">
        <a class="nav-link" href="/">Home <span class="sr-only">(current)</span></a>
      </li>
    </ul>
  </div>
</nav>

<main role="main" class="container">
  <div class="starter-template">
  	 	<div id="widget-container"></div>
  </div>
</main>

</body>

</html>